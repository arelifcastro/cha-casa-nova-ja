<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Presentes - Areli & Jordan</title>
    
    <!-- React & Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Pinyon+Script&family=Playfair+Display:wght@400;600;700;900&display=swap" rel="stylesheet">

    <!-- Firebase (Compat Version para estabilidade) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f4f5f0; color: #2f3b1c; overflow-x: hidden; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .font-script { font-family: 'Pinyon Script', cursive; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .zoom-in { animation: zoomIn 0.3s ease-out; }
        @keyframes zoomIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .spinner { width: 40px; height: 40px; border: 4px solid #e5e7eb; border-top: 4px solid #556b2f; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #initial-loader { position: fixed; inset: 0; background: #f4f5f0; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s ease; }
    </style>
</head>
<body>
    <div id="initial-loader">
        <div class="spinner"></div>
        <p style="margin-top: 15px; color: #556b2f; font-weight: bold; font-family: 'Playfair Display', serif;">A carregar a lista...</p>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const Icons = {
            Gift: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="8" width="18" height="4" rx="1"/><path d="M12 8v13"/><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"/><path d="M7.5 8a2.5 2.5 0 0 1 0-5C11 3 12 8 12 8s1-5 4.5-5a2.5 2.5 0 0 1 0 5H12z"/></svg>,
            CheckCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            User: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
            Calendar: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
            MapPin: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>,
            Search: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>,
            Heart: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
            Plus: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
            Trash2: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>,
            Edit2: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>,
            X: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            Upload: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>,
            Settings: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>,
            Copy: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>,
            ExternalLink: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
            Lock: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
        };

        const firebaseConfig = {
            apiKey: "AIzaSyD_DOSIPk_VEEhj_JtnA21eSdab2nKIb1E",
            authDomain: "cha-casa-nova-133e0.firebaseapp.com",
            projectId: "cha-casa-nova-133e0",
            storageBucket: "cha-casa-nova-133e0.firebasestorage.app",
            messagingSenderId: "970093105832",
            appId: "1:970093105832:web:5f43a1248a9c4fa7aae89d"
        };

        // Firebase Init com verificação
        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
        } catch (err) {
            console.error("Firebase init error:", err);
        }

        const auth = firebase.auth();
        const db = firebase.firestore();
        const appId = 'lista-presentes-v3-olive';
        const ADMIN_PASSWORD = "amor"; 

        const THEME = {
            primary: 'bg-[#556b2f]', 
            primaryHover: 'hover:bg-[#3f4f22]',
            light: 'bg-[#f4f5f0]',
            text: 'text-[#2f3b1c]',
            textLight: 'text-[#556b2f]',
            beige: 'text-[#d2b48c]'
        };

        const { useState, useEffect, useMemo, useRef } = React;

        // --- GiftCard Component ---
        const GiftCard = ({ gift, user, onToggle, onExpand, theme }) => {
            const [imgIndex, setImgIndex] = useState(0);
            const images = useMemo(() => {
                if (gift.images && gift.images.length > 0) return gift.images;
                if (gift.image) return [gift.image];
                return ['https://placehold.co/600x400?text=Sem+Imagem'];
            }, [gift.images, gift.image]);

            useEffect(() => {
                if (images.length <= 1) return;
                const intervalId = setInterval(() => setImgIndex((p) => (p + 1) % images.length), 3500);
                return () => clearInterval(intervalId);
            }, [images.length]);

            const isTaken = !!gift.takenBy;
            const takenByMe = gift.takenById === user?.uid;

            return (
                <div className={`group relative bg-white rounded-xl shadow-sm border transition-all duration-300 overflow-hidden flex flex-col h-full ${isTaken ? (takenByMe ? 'border-green-500 ring-1 ring-green-100' : 'opacity-70 grayscale-[0.3]') : 'border-[#dce0d5] hover:shadow-xl hover:-translate-y-1 hover:border-[#556b2f]'}`}>
                    <div className="relative h-48 w-full overflow-hidden bg-gray-100 cursor-pointer" onClick={() => onExpand(gift)}>
                        <img src={images[imgIndex]} className="w-full h-full object-cover transition-opacity duration-1000" alt={gift.name} />
                        {images.length > 1 && (
                            <div className="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1">
                                {images.map((_, i) => (
                                    <div key={i} className={`h-1 rounded-full transition-all ${i === imgIndex ? 'w-4 bg-white' : 'w-1 bg-white/40'}`} />
                                ))}
                            </div>
                        )}
                    </div>
                    <div className="p-4 flex-1 flex flex-col cursor-pointer" onClick={() => onExpand(gift)}>
                        <span className="inline-block px-2 py-1 bg-[#f4f5f0] rounded text-[10px] text-[#556b2f] font-bold uppercase mb-2 w-fit">{gift.category}</span>
                        <h3 className="font-serif font-bold text-lg text-[#2f3b1c] leading-tight line-clamp-2">{gift.name}</h3>
                        
                        {gift.price && (
                            <div className="mt-3 inline-block px-4 py-2 bg-[#556b2f]/10 text-[#556b2f] rounded-lg font-black text-lg border border-[#556b2f]/20 shadow-sm w-fit transition-transform hover:scale-105">
                                R$ {gift.price}
                            </div>
                        )}

                        <div className="mt-auto pt-4">
                            {isTaken ? (
                                <div className={`w-full py-2.5 rounded-lg text-sm flex items-center justify-center gap-2 font-medium ${takenByMe ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-400'}`}>
                                    <Icons.User size={16} /> {takenByMe ? 'Reservado por você' : 'Reservado'}
                                </div>
                            ) : (
                                <button onClick={(e) => { e.stopPropagation(); onToggle(gift); }} className={`w-full py-2.5 rounded-lg ${theme.primary} text-white font-medium text-sm flex items-center justify-center gap-2 shadow-md hover:opacity-95`}><Icons.Heart size={16} /> Presentear</button>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // --- Main App Component ---
        function App() {
            const [user, setUser] = useState(null);
            const [viewMode, setViewMode] = useState('guest');
            const [adminTab, setAdminTab] = useState('gifts');
            const [gifts, setGifts] = useState([]);
            const [rsvps, setRsvps] = useState([]);
            const [dynamicCategories, setDynamicCategories] = useState(['Cozinha', 'Sala', 'Quarto', 'Banheiro', 'Eletro', 'Decoração', 'Cotistas']);
            const [siteConfig, setSiteConfig] = useState({
                eventTitle: "Chá de Casa Nova",
                eventDate: "21 de Fevereiro, 2026",
                eventLocation: "Salão de Festas",
                welcomeMessage: "A sua presença é o nosso maior presente!",
                pixKey: "",
                mercadoPagoLink: ""
            });

            const [guestName, setGuestName] = useState(() => localStorage.getItem('guest_name') || '');
            const [guestPhone, setGuestPhone] = useState(() => localStorage.getItem('guest_phone') || '');
            const [isNameSet, setIsNameSet] = useState(() => !!localStorage.getItem('guest_name'));
            const [loading, setLoading] = useState(true);
            const [searchTerm, setSearchTerm] = useState('');
            const [categoryFilter, setCategoryFilter] = useState('Todos');
            
            const [showPaymentModal, setShowPaymentModal] = useState(null);
            const [showRsvpModal, setShowRsvpModal] = useState(false);
            const [expandedGift, setExpandedGift] = useState(null);
            const [expandedImgIndex, setExpandedImgIndex] = useState(0);
            const [showAdminModal, setShowAdminModal] = useState(false);
            const [editingGift, setEditingGift] = useState(null);
            const [formData, setFormData] = useState({ name: '', category: 'Cozinha', images: [], price: '', paymentStatus: 'não pago' });
            
            // Estados para confirmações internas (evita confirm() nativo)
            const [confirmReleaseId, setConfirmReleaseId] = useState(null);
            const [confirmDeleteId, setConfirmDeleteId] = useState(null);

            const fileInputRef = useRef(null);

            useEffect(() => {
                const unsub = auth.onAuthStateChanged((u) => {
                    if (!u) auth.signInAnonymously();
                    setUser(u);
                });
                return () => unsub();
            }, []);

            useEffect(() => {
                if (!user) return;
                const path = db.collection('artifacts').doc(appId).collection('public').doc('data');
                
                const unsubGifts = path.collection('gift_list_items').onSnapshot(s => { 
                    setGifts(s.docs.map(d => ({id: d.id, ...d.data()}))); 
                    setLoading(false); 
                    // Remove loader assim que os dados carregarem
                    const loader = document.getElementById('initial-loader');
                    if(loader) { loader.style.opacity = '0'; setTimeout(() => loader.style.display = 'none', 500); }
                });

                const unsubRsvps = path.collection('rsvp_list').onSnapshot(s => setRsvps(s.docs.map(d => ({id: d.id, ...d.data()}))));
                const unsubConfig = path.collection('site_config').doc('main').onSnapshot(s => s.exists && setSiteConfig(prev => ({...prev, ...s.data()})));
                const unsubCats = path.collection('categories').doc('list').onSnapshot(s => s.exists && setDynamicCategories(s.data().items));

                return () => { unsubGifts(); unsubRsvps(); unsubConfig(); unsubCats(); };
            }, [user]);

            const handleToggleGift = async (gift) => {
                const ref = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('gift_list_items').doc(gift.id);
                try {
                    await ref.update({ 
                        takenBy: guestName || "Convidado", 
                        takenById: user.uid, 
                        paymentStatus: 'não pago',
                        reservationDate: new Date().toISOString()
                    });
                    setShowPaymentModal(null);
                    setExpandedGift(null);
                } catch (e) {
                    console.error("Erro ao reservar:", e);
                }
            };

            const handleReleaseReservation = async (id) => {
                try {
                    await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('gift_list_items').doc(id).update({ 
                        takenBy: null, 
                        takenById: null, 
                        paymentStatus: 'não pago' 
                    });
                    setConfirmReleaseId(null);
                } catch (error) { console.error(error); }
            };

            const handleDeleteItem = async (id) => {
                try {
                    await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('gift_list_items').doc(id).delete();
                    setConfirmDeleteId(null);
                } catch (error) { console.error(error); }
            };

            const handleSaveGift = async (e) => {
                e.preventDefault();
                const col = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('gift_list_items');
                if (editingGift) await col.doc(editingGift.id).update(formData);
                else await col.add({...formData, takenBy: null, takenById: null, paymentStatus: 'não pago'});
                setShowAdminModal(false);
            };

            const handleFileUpload = (e) => {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onloadend = () => setFormData(prev => ({ ...prev, images: [...prev.images, reader.result] }));
                    reader.readAsDataURL(file);
                });
            };

            const openPaymentLink = () => {
                if (!siteConfig.mercadoPagoLink || siteConfig.mercadoPagoLink === "#") {
                    alert("O link de pagamento ainda não foi configurado.");
                    return;
                }
                let url = siteConfig.mercadoPagoLink.startsWith('http') ? siteConfig.mercadoPagoLink : 'https://' + siteConfig.mercadoPagoLink;
                window.open(url, '_blank');
            };

            const filteredGifts = useMemo(() => gifts.filter(g => 
                g.name.toLowerCase().includes(searchTerm.toLowerCase()) && 
                (categoryFilter === 'Todos' || g.category === categoryFilter)
            ), [gifts, searchTerm, categoryFilter]);

            const stats = useMemo(() => ({
                available: gifts.filter(g => !g.takenBy).length,
                reserved: gifts.filter(g => g.takenBy).length
            }), [gifts]);

            const currentUserRsvp = useMemo(() => rsvps.find(r => r.id === user?.uid), [rsvps, user?.uid]);

            if (!isNameSet && viewMode === 'guest') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4 bg-[#f4f5f0]">
                        <div className="bg-white max-w-md w-full rounded-[2.5rem] p-8 shadow-xl text-center zoom-in">
                            <h1 className="text-3xl font-serif font-bold mb-6 text-[#2f3b1c]">Bem-vindos!</h1>
                            <form onSubmit={(e) => { e.preventDefault(); localStorage.setItem('guest_name', guestName); localStorage.setItem('guest_phone', guestPhone); setIsNameSet(true); }} className="space-y-4">
                                <input type="text" placeholder="Seu Nome" className="w-full p-4 rounded-2xl bg-gray-50 border outline-none font-bold focus:ring-2 focus:ring-[#556b2f] transition-all" value={guestName} onChange={e => setGuestName(e.target.value)} required />
                                <input type="tel" placeholder="Seu Telefone" className="w-full p-4 rounded-2xl bg-gray-50 border outline-none font-bold focus:ring-2 focus:ring-[#556b2f] transition-all" value={guestPhone} onChange={e => setGuestPhone(e.target.value)} required />
                                <button className={`w-full py-4 rounded-2xl text-white font-bold transition-all ${THEME.primary}`}>Entrar</button>
                            </form>
                            <button onClick={() => setViewMode('admin-login')} className="mt-6 text-gray-300 text-xs uppercase tracking-widest font-bold hover:text-[#556b2f]">Painel Administrativo</button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen pb-20 fade-in">
                    {user && viewMode === 'guest' && (
                        <button onClick={() => setViewMode('admin-login')} className="fixed bottom-6 right-6 z-[300] bg-white p-3 rounded-full shadow-lg text-gray-400 hover:text-[#556b2f] border transition-all">
                            <Icons.Settings size={20} />
                        </button>
                    )}

                    <header className="bg-white shadow-sm sticky top-0 z-20 px-4 py-3">
                        <div className="max-w-6xl mx-auto flex justify-between items-center">
                            <h1 className="font-serif font-bold flex items-center gap-2 text-[#2f3b1c]"><Icons.Gift className="text-[#556b2f]"/> Lista de Presentes</h1>
                            <button onClick={() => setViewMode('admin-login')} className="p-2 text-gray-300 hover:text-[#556b2f] transition-colors"><Icons.Lock size={16}/></button>
                        </div>
                    </header>

                    <div className={`${THEME.primary} text-white py-20 px-4 text-center shadow-inner relative overflow-hidden`}>
                        <div className="max-w-4xl mx-auto relative z-10">
                            <h1 className="text-7xl md:text-9xl font-script mb-4 text-[#d2b48c] drop-shadow-md">Areli & Jordan</h1>
                            <h2 className="text-lg uppercase tracking-[0.3em] font-medium opacity-80 mb-8">{siteConfig.eventTitle}</h2>
                            <p className="italic font-light opacity-90 max-w-lg mx-auto border-t border-b border-white/20 py-4 mb-10">{siteConfig.welcomeMessage}</p>
                            
                            <button 
                                onClick={() => setShowRsvpModal(true)} 
                                className={`px-10 py-4 rounded-full font-bold shadow-2xl transition-transform hover:scale-105 active:scale-95 text-sm uppercase tracking-widest ${currentUserRsvp?.status === 'confirmed' ? 'bg-green-600 text-white' : currentUserRsvp?.status === 'declined' ? 'bg-red-600 text-white' : 'bg-white text-[#2f3b1c]'}`}
                            >
                                {currentUserRsvp?.status === 'confirmed' ? '✓ Presença Confirmada' : currentUserRsvp?.status === 'declined' ? '✕ Não poderei ir' : 'Confirmar Presença'}
                            </button>

                            <div className="flex justify-center gap-6 mt-12 text-sm font-medium flex-wrap">
                                <div className="flex items-center gap-2 bg-white/10 px-6 py-2 rounded-full border border-white/20 backdrop-blur-sm"><Icons.Calendar size={16} className="text-[#d2b48c]"/> {siteConfig.eventDate}</div>
                                <div className="flex items-center gap-2 bg-white/10 px-6 py-2 rounded-full border border-white/20 backdrop-blur-sm"><Icons.MapPin size={16} className="text-[#d2b48c]"/> {siteConfig.eventLocation}</div>
                            </div>
                            
                            <div className="flex justify-center gap-4 mt-10">
                                <div className="bg-white p-4 rounded-2xl shadow-lg min-w-[140px] flex flex-col items-center justify-center border border-white/20">
                                    <Icons.Gift size={24} className="text-[#556b2f] mb-2" />
                                    <span className="block text-[10px] uppercase font-black text-gray-300 tracking-widest mb-1">Disponíveis</span>
                                    <span className="text-3xl font-black text-[#556b2f]">{stats.available}</span>
                                </div>
                                <div className="bg-white p-4 rounded-2xl shadow-lg min-w-[140px] flex flex-col items-center justify-center border border-white/20">
                                    <Icons.Heart size={24} className="text-red-500 mb-2" />
                                    <span className="block text-[10px] uppercase font-black text-gray-300 tracking-widest mb-1">Reservados</span>
                                    <span className="text-3xl font-black text-red-500">{stats.reserved}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <main className="max-w-6xl mx-auto px-4 mt-12">
                        <div className="flex flex-col md:flex-row gap-4 mb-8">
                            <div className="flex-1 bg-white p-4 rounded-2xl shadow-sm flex items-center gap-4 border border-gray-100">
                                <Icons.Search className="text-gray-400" />
                                <input type="text" placeholder="O que deseja presentear?" className="flex-1 outline-none text-gray-700 bg-transparent font-bold" value={searchTerm} onChange={e => setSearchTerm(e.target.value)} />
                            </div>
                            <div className="flex gap-2 overflow-x-auto pb-2 no-scrollbar">
                                <button onClick={() => setCategoryFilter('Todos')} className={`px-6 py-3 rounded-full text-xs font-bold border transition-all whitespace-nowrap ${categoryFilter === 'Todos' ? `${THEME.primary} text-white border-transparent` : 'bg-white text-gray-400 border-gray-200'}`}>Todos</button>
                                {dynamicCategories.map(cat => (
                                    <button key={cat} onClick={() => setCategoryFilter(cat)} className={`px-6 py-3 rounded-full text-xs font-bold border transition-all whitespace-nowrap ${categoryFilter === cat ? `${THEME.primary} text-white border-transparent` : 'bg-white text-gray-400 border-gray-200'}`}>{cat}</button>
                                ))}
                            </div>
                        </div>

                        {loading ? (
                            <div className="flex flex-col items-center py-20 gap-4 text-gray-400"><Icons.Loader2 size={40} className="animate-spin" /><p className="font-bold text-sm tracking-widest uppercase">A carregar...</p></div>
                        ) : (
                            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                                {filteredGifts.length > 0 ? filteredGifts.map(g => (
                                    <GiftCard key={g.id} gift={g} user={user} theme={THEME} onToggle={setShowPaymentModal} onExpand={(gift) => { setExpandedGift(gift); setExpandedImgIndex(0); }} />
                                )) : (
                                    <div className="col-span-full py-20 text-center border-4 border-dashed border-gray-100 rounded-[3rem] text-gray-300 font-bold italic">Nenhum item encontrado nesta categoria.</div>
                                )}
                            </div>
                        )}
                    </main>

                    {/* Modal de Pagamento */}
                    {showPaymentModal && (
                        <div className="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
                            <div className="bg-white rounded-[3rem] max-w-sm w-full p-10 shadow-2xl text-center relative zoom-in">
                                <button onClick={() => setShowPaymentModal(null)} className="absolute top-6 right-6 text-gray-300 hover:text-red-500 transition-colors"><Icons.X /></button>
                                <Icons.Gift size={40} className="mx-auto text-[#556b2f] mb-4" />
                                <h3 className="text-2xl font-bold mb-1 text-[#2f3b1c]">Presentear</h3>
                                <p className="text-xs text-gray-400 mb-8 italic">"{showPaymentModal.name}"</p>
                                
                                <div className="space-y-6 mb-10">
                                    <div className="text-left">
                                        <label className="text-[10px] font-black text-gray-400 uppercase ml-2 mb-2 block tracking-widest">Pagar via Pix</label>
                                        <div className="flex gap-2">
                                            <div className="flex-1 bg-gray-50 p-4 rounded-2xl text-xs font-mono border truncate">
                                                {siteConfig.pixKey || "Chave não configurada"}
                                            </div>
                                            {siteConfig.pixKey && <button onClick={() => { navigator.clipboard.writeText(siteConfig.pixKey); alert('Copiado!'); }} className="p-4 bg-gray-100 rounded-2xl text-[#556b2f] hover:bg-gray-200 transition-colors"><Icons.Copy size={18}/></button>}
                                        </div>
                                    </div>
                                    <div className="text-left">
                                        <label className="text-[10px] font-black text-gray-400 uppercase ml-2 mb-2 block tracking-widest">Pagamento Online</label>
                                        <button onClick={openPaymentLink} className="w-full flex items-center justify-between p-4 bg-blue-50 text-blue-600 rounded-2xl text-sm font-bold border border-blue-100 hover:bg-blue-100 transition-colors">Abrir Link <Icons.ExternalLink size={18}/></button>
                                    </div>
                                </div>

                                <div className="flex flex-col gap-3">
                                    <button onClick={() => handleToggleGift(showPaymentModal)} className={`w-full py-4 rounded-2xl text-white font-black uppercase tracking-widest text-[10px] shadow-lg transition-all ${THEME.primary} hover:opacity-90`}>Confirmar Envio do Presente</button>
                                    <button onClick={() => setShowPaymentModal(null)} className="py-2 text-gray-300 text-[10px] font-bold uppercase tracking-widest hover:text-[#556b2f]">Voltar</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Detalhes do Item */}
                    {expandedGift && (
                        <div className="fixed inset-0 z-[150] bg-white overflow-y-auto p-6 md:p-12 fade-in">
                            <button onClick={() => setExpandedGift(null)} className="fixed top-8 right-8 z-[160] bg-gray-100 p-3 rounded-full hover:bg-gray-200 transition-colors"><Icons.X /></button>
                            <div className="max-w-5xl mx-auto flex flex-col md:flex-row gap-12 items-center min-h-full">
                                <div className="w-full md:w-1/2 relative">
                                    <img src={(expandedGift.images?.length > 0 ? expandedGift.images : [expandedGift.image])[expandedImgIndex]} className="w-full aspect-square object-cover rounded-[3rem] shadow-2xl border transition-opacity duration-1000" />
                                    {((expandedGift.images?.length || 0) > 1) && (
                                        <div className="absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2">
                                            {expandedGift.images.map((_, i) => <div key={i} className={`h-1.5 rounded-full transition-all ${i === expandedImgIndex ? `w-8 ${THEME.primary}` : 'w-2 bg-black/20'}`} />)}
                                        </div>
                                    )}
                                </div>
                                <div className="w-full md:w-1/2 flex flex-col">
                                    <span className="text-[#556b2f] font-black uppercase tracking-[0.2em] text-xs mb-4">{expandedGift.category}</span>
                                    <h2 className="text-4xl md:text-6xl font-serif font-bold text-[#2f3b1c] mb-4 leading-tight">{expandedGift.name}</h2>
                                    {expandedGift.price && <div className="mb-8 inline-block px-6 py-3 bg-[#556b2f]/10 text-[#556b2f] rounded-2xl font-black text-3xl border border-[#556b2f]/20 shadow-sm w-fit">R$ {expandedGift.price}</div>}
                                    {!expandedGift.takenBy && <button onClick={() => setShowPaymentModal(expandedGift)} className={`w-full py-6 rounded-3xl text-white text-xl font-black shadow-xl transition-all ${THEME.primary} hover:opacity-95 flex items-center justify-center gap-3`}><Icons.Heart fill="white" /> PRESENTEAR AGORA</button>}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* PAINEL ADMIN */}
                    {viewMode === 'admin-panel' && (
                        <div className="fixed inset-0 bg-white z-[500] overflow-y-auto pb-20">
                            <header className={`${THEME.primary} text-white p-6 sticky top-0 flex justify-between items-center shadow-lg z-10`}>
                                <div className="font-bold flex items-center gap-2 uppercase tracking-widest text-sm"><Icons.Lock size={18}/> Painel Admin</div>
                                <button onClick={() => setViewMode('guest')} className="text-xs bg-white/20 px-4 py-2 rounded-full font-bold hover:bg-white/30">Sair do Painel</button>
                            </header>

                            <div className="max-w-6xl mx-auto p-6">
                                <div className="flex gap-4 mb-8 overflow-x-auto no-scrollbar border-b">
                                    {['gifts', 'reservados', 'prices', 'config', 'rsvp'].map(t => (
                                        <button key={t} onClick={() => setAdminTab(t)} className={`pb-4 px-6 font-black text-[10px] uppercase tracking-widest transition-all whitespace-nowrap ${adminTab === t ? 'border-b-4 border-[#556b2f] text-[#556b2f]' : 'text-gray-300'}`}>
                                            {t === 'gifts' ? 'Itens' : t === 'reservados' ? 'Reservas' : t === 'prices' ? 'Preços' : t === 'config' ? 'Site' : 'Convidados'}
                                        </button>
                                    ))}
                                </div>

                                {adminTab === 'gifts' && (
                                    <div className="fade-in">
                                        <button onClick={() => { setEditingGift(null); setFormData({name: '', category: 'Cozinha', images: [], price: '', paymentStatus: 'não pago'}); setShowAdminModal(true); }} className={`mb-8 px-8 py-4 rounded-2xl text-white font-black text-xs uppercase tracking-widest flex items-center gap-2 shadow-lg transition-all ${THEME.primary} hover:opacity-90`}>
                                            <Icons.Plus size={18}/> Novo Presente
                                        </button>
                                        <div className="grid gap-4">
                                            {gifts.map(g => (
                                                <div key={g.id} className="p-4 bg-white rounded-2xl flex justify-between items-center border group shadow-sm hover:border-[#556b2f] transition-all">
                                                    <div className="flex items-center gap-4 overflow-hidden">
                                                        <img src={(g.images?.[0] || g.image) || 'https://placehold.co/100'} className="w-16 h-16 rounded-xl object-cover border flex-shrink-0" />
                                                        <div className="truncate"><p className="font-bold text-[#2f3b1c] truncate">{g.name}</p><p className="text-[10px] text-gray-400 font-bold uppercase">{g.category} {g.price && `• R$ ${g.price}`}</p></div>
                                                    </div>
                                                    <div className="flex gap-2">
                                                        <button onClick={() => { setEditingGift(g); setFormData({...g, images: g.images || (g.image ? [g.image] : [])}); setShowAdminModal(true); }} className="p-3 text-blue-500 bg-blue-50 rounded-xl hover:bg-blue-100 transition-colors"><Icons.Edit2 size={18}/></button>
                                                        {confirmDeleteId === g.id ? (
                                                            <div className="flex gap-1">
                                                                <button onClick={() => handleDeleteItem(g.id)} className="bg-red-600 text-white px-3 py-2 rounded-xl text-[10px] font-bold">Sim</button>
                                                                <button onClick={() => setConfirmDeleteId(null)} className="bg-gray-200 text-gray-500 px-3 py-2 rounded-xl text-[10px] font-bold">Não</button>
                                                            </div>
                                                        ) : (
                                                            <button onClick={() => setConfirmDeleteId(g.id)} className="p-3 text-red-500 bg-red-50 rounded-xl hover:bg-red-100 transition-colors"><Icons.Trash2 size={18}/></button>
                                                        )}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {adminTab === 'reservados' && (
                                    <div className="bg-white p-8 rounded-[3rem] border fade-in">
                                        <h2 className="text-2xl font-serif font-bold text-[#2f3b1c] mb-6">Reservas</h2>
                                        <div className="divide-y space-y-4">
                                            {gifts.filter(g => g.takenBy).map(g => (
                                                <div key={g.id} className="py-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 group">
                                                    <div className="flex items-center gap-4">
                                                        <img src={g.images?.[0] || g.image} className="w-12 h-12 rounded-lg object-cover border" />
                                                        <div><p className="font-bold text-sm">{g.name}</p><p className="text-[10px] text-gray-400 font-bold uppercase tracking-widest">Reservado por: <span className="text-[#556b2f] font-black">{g.takenBy}</span></p></div>
                                                    </div>
                                                    <div className="flex flex-wrap items-center gap-3">
                                                        <select value={g.paymentStatus || 'não pago'} onChange={(e) => db.collection('artifacts').doc(appId).collection('public').doc('data').collection('gift_list_items').doc(g.id).update({ paymentStatus: e.target.value })} className={`text-[10px] font-black px-4 py-2 rounded-full border outline-none cursor-pointer transition-all ${g.paymentStatus === 'pago' ? 'bg-green-100 text-green-700 border-green-200' : 'bg-yellow-50 text-yellow-600 border-yellow-100'}`}><option value="não pago">NÃO PAGO</option><option value="pago">PAGO</option></select>
                                                        {confirmReleaseId === g.id ? (
                                                            <div className="flex gap-1 bg-red-50 p-1 rounded-full border"><button onClick={() => handleReleaseReservation(g.id)} className="bg-red-600 text-white px-3 py-1.5 rounded-full text-[9px] font-black uppercase">Liberar</button><button onClick={() => setConfirmReleaseId(null)} className="bg-gray-200 text-gray-600 px-3 py-1.5 rounded-full text-[9px] font-black uppercase">Cancelar</button></div>
                                                        ) : (
                                                            <button onClick={() => setConfirmReleaseId(g.id)} className="px-4 py-2 bg-red-50 text-red-600 rounded-full text-[10px] font-black uppercase border hover:bg-red-100 transition-colors">Liberar Reserva</button>
                                                        )}
                                                    </div>
                                                </div>
                                            ))}
                                            {gifts.filter(g => g.takenBy).length === 0 && <p className="py-20 text-center text-gray-300 italic">Nenhuma reserva.</p>}
                                        </div>
                                    </div>
                                )}
                                
                                {adminTab === 'prices' && (
                                    <div className="bg-gray-50 p-8 rounded-[3rem] border fade-in">
                                        <h2 className="text-2xl font-serif font-bold mb-6">Ajuste de Preços</h2>
                                        <div className="space-y-4">
                                            {gifts.map(g => (
                                                <div key={g.id} className="flex items-center justify-between p-4 bg-white rounded-2xl border border-gray-100 hover:border-[#556b2f] transition-all">
                                                    <span className="font-bold text-gray-700 text-sm truncate max-w-[200px]">{g.name}</span>
                                                    <div className="flex items-center gap-2"><span className="text-xs font-black text-gray-300">R$</span><input type="text" className="w-24 p-2 bg-gray-50 border rounded-xl font-mono text-xs font-bold text-center outline-none focus:ring-2 focus:ring-[#556b2f]" placeholder="0,00" value={g.price || ''} onChange={(e) => db.collection('artifacts').doc(appId).collection('public').doc('data').collection('gift_list_items').doc(g.id).update({ price: e.target.value })} /></div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {adminTab === 'config' && (
                                    <div className="space-y-8 bg-gray-50 p-8 md:p-12 rounded-[3rem] border fade-in">
                                        <h2 className="text-2xl font-serif font-bold">Configurações do Site</h2>
                                        <div className="grid md:grid-cols-2 gap-6">
                                            <div className="space-y-4">
                                                <div><label className="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Título</label><input className="w-full p-4 border rounded-2xl font-bold font-serif text-lg outline-none focus:ring-2 focus:ring-[#556b2f]" value={siteConfig.eventTitle} onChange={e => setSiteConfig({...siteConfig, eventTitle: e.target.value})} /></div>
                                                <div><label className="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Data</label><input className="w-full p-4 border rounded-2xl font-bold outline-none focus:ring-2 focus:ring-[#556b2f]" value={siteConfig.eventDate} onChange={e => setSiteConfig({...siteConfig, eventDate: e.target.value})} /></div>
                                                <div><label className="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Local</label><input className="w-full p-4 border rounded-2xl font-bold outline-none focus:ring-2 focus:ring-[#556b2f]" value={siteConfig.eventLocation} onChange={e => setSiteConfig({...siteConfig, eventLocation: e.target.value})} /></div>
                                            </div>
                                            <div className="space-y-4">
                                                <div><label className="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Chave PIX</label><input className="w-full p-4 border rounded-2xl font-bold font-mono outline-none focus:ring-2 focus:ring-[#556b2f]" value={siteConfig.pixKey} onChange={e => setSiteConfig({...siteConfig, pixKey: e.target.value})} /></div>
                                                <div><label className="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Link Pagamento</label><input className="w-full p-4 border rounded-2xl font-bold outline-none focus:ring-2 focus:ring-[#556b2f] text-xs" value={siteConfig.mercadoPagoLink} placeholder="https://..." onChange={e => setSiteConfig({...siteConfig, mercadoPagoLink: e.target.value})} /></div>
                                                <div><label className="text-[10px] font-bold text-gray-400 uppercase mb-2 block">Mensagem</label><textarea className="w-full p-4 border rounded-2xl font-bold text-xs h-24 outline-none focus:ring-2 focus:ring-[#556b2f] resize-none" value={siteConfig.welcomeMessage} onChange={e => setSiteConfig({...siteConfig, welcomeMessage: e.target.value})} /></div>
                                            </div>
                                        </div>
                                        <button onClick={async () => { await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('site_config').doc('main').set(siteConfig); alert('Salvo!'); }} className={`w-full py-5 rounded-3xl text-white font-black uppercase tracking-widest text-xs shadow-xl transition-all ${THEME.primary} hover:opacity-90`}>Salvar Alterações</button>
                                    </div>
                                )}

                                {adminTab === 'rsvp' && (
                                    <div className="bg-white p-8 rounded-[3rem] border fade-in">
                                        <h2 className="text-2xl font-serif font-bold mb-6 text-[#2f3b1c]">Lista de Presença</h2>
                                        <div className="divide-y">
                                            {rsvps.map(r => (
                                                <div key={r.id} className="py-4 flex justify-between items-center group">
                                                    <div><p className="font-bold text-[#2f3b1c]">{r.name}</p><p className="text-[10px] text-gray-400 font-bold">{r.phone}</p></div>
                                                    <span className={`text-[10px] font-black px-4 py-1 rounded-full border ${r.status === 'confirmed' ? 'bg-green-50 text-green-700 border-green-100' : 'bg-red-50 text-red-500 border-red-100'}`}>{r.status === 'confirmed' ? '✓ CONFIRMADO' : '✕ NÃO VAI'}</span>
                                                </div>
                                            ))}
                                            {rsvps.length === 0 && <p className="py-20 text-center text-gray-300 italic">Sem confirmações.</p>}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Modal de Cadastro/Edição de Item */}
                    {showAdminModal && (
                        <div className="fixed inset-0 z-[600] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
                            <div className="bg-white p-10 rounded-[3rem] w-full max-w-lg max-h-[90vh] overflow-y-auto shadow-2xl relative zoom-in">
                                <button onClick={() => setShowAdminModal(false)} className="absolute top-8 right-8 text-gray-300 hover:text-red-500 transition-colors"><Icons.X /></button>
                                <h3 className="text-2xl font-serif font-bold mb-8 text-[#2f3b1c]">Dados do Presente</h3>
                                <form onSubmit={handleSaveGift} className="space-y-6">
                                    <input className="w-full p-4 border rounded-2xl font-bold outline-none focus:ring-2 focus:ring-[#556b2f]" placeholder="Nome do Presente" value={formData.name} onChange={e => setFormData({...formData, name: e.target.value})} required />
                                    <div className="flex gap-4">
                                        <input className="flex-1 p-4 border rounded-2xl font-bold outline-none focus:ring-2 focus:ring-[#556b2f]" placeholder="Preço (Ex: 150,00)" value={formData.price} onChange={e => setFormData({...formData, price: e.target.value})} />
                                        <select className="flex-1 p-4 border rounded-2xl font-bold outline-none bg-white cursor-pointer" value={formData.category} onChange={e => setFormData({...formData, category: e.target.value})}>{dynamicCategories.map(c => <option key={c} value={c}>{c}</option>)}</select>
                                    </div>
                                    <div>
                                        <label className="text-[10px] font-bold text-gray-400 uppercase mb-2 block tracking-widest">Fotos (Upload)</label>
                                        <div onClick={() => fileInputRef.current.click()} className="w-full py-8 border-4 border-dashed border-gray-100 rounded-[2rem] flex flex-col items-center justify-center text-gray-300 hover:text-[#556b2f] hover:border-[#556b2f] cursor-pointer group">
                                            <Icons.Upload size={32} className="mb-2 group-hover:scale-110 transition-transform" />
                                            <span className="text-xs font-black uppercase tracking-widest">Selecionar Imagens</span>
                                            <input type="file" ref={fileInputRef} multiple accept="image/*" className="hidden" onChange={handleFileUpload} />
                                        </div>
                                        <div className="grid grid-cols-4 gap-2 mt-4">
                                            {formData.images.map((img, i) => (
                                                <div key={i} className="relative aspect-square rounded-xl overflow-hidden border">
                                                    <img src={img} className="w-full h-full object-cover" />
                                                    <button type="button" onClick={() => setFormData(p => ({...p, images: p.images.filter((_, idx) => idx !== i)}))} className="absolute top-1 right-1 bg-red-500 text-white rounded-full p-1"><Icons.X size={10} /></button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    <button type="submit" className={`w-full py-4 rounded-2xl text-white font-black uppercase tracking-widest text-[10px] shadow-lg ${THEME.primary}`}>Salvar Presente</button>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* Login Admin */}
                    {viewMode === 'admin-login' && (
                        <div className="fixed inset-0 bg-[#f4f5f0] z-[400] flex items-center justify-center p-4">
                            <div className="max-w-sm w-full text-center bg-white p-12 rounded-[3rem] shadow-2xl border zoom-in">
                                <h2 className="text-2xl font-serif font-bold mb-8">Acesso Restrito</h2>
                                <input type="password" id="admin-p" placeholder="Senha" className="w-full p-5 border rounded-3xl text-center mb-6 font-bold outline-none focus:ring-2 focus:ring-[#556b2f]" onKeyDown={(e) => e.key === 'Enter' && (e.target.value === ADMIN_PASSWORD ? setViewMode('admin-panel') : alert('Senha incorreta'))} />
                                <button onClick={() => document.getElementById('admin-p').value === ADMIN_PASSWORD ? setViewMode('admin-panel') : alert('Senha incorreta')} className={`w-full py-5 rounded-3xl text-white font-black uppercase tracking-widest text-[10px] shadow-xl ${THEME.primary}`}>Entrar</button>
                                <button onClick={() => setViewMode('guest')} className="mt-6 text-gray-400 text-[10px] font-bold uppercase tracking-widest hover:text-[#556b2f]">Voltar</button>
                            </div>
                        </div>
                    )}

                    {/* Modal RSVP */}
                    {showRsvpModal && (
                        <div className="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
                            <div className="bg-white p-10 rounded-[3rem] w-full max-w-sm shadow-2xl text-center relative zoom-in">
                                <button onClick={() => setShowRsvpModal(false)} className="absolute top-6 right-6 text-gray-300 hover:text-red-500 transition-colors"><Icons.X /></button>
                                <h3 className="text-2xl font-bold mb-4">Confirmar Presença</h3>
                                <p className="text-gray-400 text-sm mb-8">Você virá celebrar conosco?</p>
                                <div className="space-y-3">
                                    <button onClick={async () => { await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('rsvp_list').doc(user.uid).set({ name: guestName, phone: guestPhone, status: 'confirmed', userId: user.uid, date: new Date().toISOString() }); setShowRsvpModal(false); }} className="w-full p-4 bg-green-50 text-green-700 rounded-2xl font-black border-2 border-green-100 uppercase tracking-widest text-xs">Sim, estarei lá! <Icons.CheckCircle className="inline ml-2" size={16}/></button>
                                    <button onClick={async () => { await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('rsvp_list').doc(user.uid).set({ name: guestName, phone: guestPhone, status: 'declined', userId: user.uid, date: new Date().toISOString() }); setShowRsvpModal(false); }} className="w-full p-4 bg-gray-50 text-gray-400 rounded-2xl font-black border uppercase tracking-widest text-xs">Infelizmente não</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
